# CPP部分课程限定与解释补充

说明：本部分内容由王超然、郑傲宇在2023年12月15日创建（另可参见链接https://h9505dssdj.feishu.cn/docx/VNt7dMwH5ov9VlxS2CzcKgkpncb），郭淳于2024年2月29日添加。


# 正文

## 1. 关于return；

return是显式指定函数返回/退出的语句，如没有return，程序可能会在函数结束后自动退出，但可能会引发未定义行为。

编程建议无论是什么类型的函数，对于每一个需要结束函数的位置，都显式地完成return语句。如下无论相关分支是否讨论完全，都最好在分支后增加return语句。


```cpp
int sgn()
{

    if(x>0)return 1;

    else if(x<0)return -1;

    else return 0;
    
    return 0xdeadbeef;//可用于异常情况定位，在部分可以使用void型函数的场景

}
```

在本课程中要求所有函数的分支均需要有全面的return语句。



## 2. 变量重用


在两个不同的花括号（称做块作用域）里可以用同一个标识符，他们会指代不同的变量。如果重新定义某些标识符，可能会导致其在某个作用域内被重用。但注意到一般同一标识符表达一个固定的含义，在逻辑上具有连续性，因而在实际编程中建议不同作用域的变量在命名中进行区分，并尽量不要重用部分约定俗成的常见标识符，如cin,cout,printf,scanf等输入输出函数与max,min,sqrt,pow等数学函数，如不得不重用，请区分大小写如Max,Sqrt,Pow，或添加前后缀/分隔符，如c_out（表示c的输出）,mypow（表示自定义的pow函数），max_int,max_T（针对类型int,模版T的max函数），pound0,pound1（两个不同的含义为pound，作用域也不同的变量）等。


在本课程中请尽量避免重用以下常见且有固定含义的标识符：


```cpp
cin,cout,printf,scanf,max,min,sqrt,pow,sqrt
```


## 3. unicode与标识符


C++在新版本中允许部分unicode字符作为标识符。但注意到版本兼容性，通用性，以及一些潜在的安全问题（unicode字符视觉欺骗攻击），
在实际编程中除了注释，不建议使用任何非ascii编码及非“数字、半角可见符号、字母、空格、tab、换行”的字符，更不建议其出现在标识符中。


在本课程中默认标识符只包括数字，字母和下划线，且不能以数字开头；对于所有全半角相似的符号，手写代码的部分均默认手写代码为半角符号。


## 4. 字符与字符串

一般来说一个单引号中只能有一个ascii字符，然而多个ascii被单引号引起来在编程实践中往往不会报错，运行结果却出乎意料的状况。

在实际编程中这种机制有其具体实现规则和应用场景，但在此不展开。

在本课程中，默认单引号内只能有一个ascii字符，为一个字符；多个字符只能使用双引号引起来，表示为字符串或字符数组。



## 5. 基于位运算的组合赋值运算符^=,|=,&=

受限于课时数，基于位运算的组合赋值运算符^=,|=,&=没讲，不作为考试要求，但在编程实践中是密码与网络安全专业及编程优化的重要内容，提倡在考试外自学。



## 6. 逗号表达式


c语言中可以用逗号","去连接几个表达式并作为一个整体的语句，返回最后一个表达式的值。

在实际编程中这种机制有其具体实现规则和应用场景，但在此不展开。

在本课程中，除声明多个相同类型变量的场景下，请尽量不要使用逗号表达式，转而使用规范的，多条分号”;“分割的语句代替，并补齐相关结构。除在声明多个指针时题目也不会出现逗号相关的表达，不会涉及逗号表达式相关的知识，也不会出现只使用逗号表达式才能完成的题目。具体示例如下：

```cpp
int   a,* b;  //a是int变量，b是指向int的指针
int * a,* b;  //a是指向int的指针,b是指向int的指针
int * a,  b;  //a是指向int的指针，b是int变量
int a,long b; //非法
```



## 7. 数字类型 

由于浮点数与整数的设计原因，浮点数使用符号位+数值表示的方式，故存在0与-0两个理应相等的值；但整数使用补码设计规避掉了这一点，故其实际范围为[0,2^n )（无符号n位整数）或[-2^(n-1),2^(n-1) ) （有符号n位整数）。

在实际编程中以上机制会影响在某个具体场景下使用变量类型的选择，并有可能引发特殊的输出BUG。

在本课程中，需要记住浮点数大致的范围与整数的具体范围，并对两种数据表达类型的精确度有认知，如下(括号内部分不重要)：

a. float：单精度值具有 4 个字节32位(包括1个符号位、一个 8 位二进制指数和一个 23 位尾数)，对应的十进制数约为6位有效数字。绝对值最大约为3.402E38。

b. double：双精度值具有 8 个字节64位(包括1个符号位、一个 11 位二进制指数和一个 52 位尾数)，对应的十进制数约15位有效数字。绝对值最大约为1.797E308。

c. long，long long：前者4字节32bits, 后者8字节64bits。在现代环境下默认int与long等长。



## 8. 关于初始化语法

常规初始化使用int a=0;对于类构造与析构，使用类似 classA A(a);的结构;C++在某个版本引入大括号的初始化int a{1};

在实际编程中常用前二者，但后者也有其使用场景，不展开讨论。 

在本课程中，要求对变量在使用运算前进行初始化或赋值；区分函数定义形式与函数调用的形式，并将前者与变量的初始化区分开。如


```cpp
int a=0;        //变量声明
int func(int);  //函数声明
func(a);        //函数调用
int func(a);    //定义了一个int型变量func并复制a的值
```



## 9. 数组长度声明

会有开一个变长数组的需求，其中长度可能是一个程序运行起来之后才会确定值的变量len，然而int array[len];的写法下放到计算机底层时考虑通用性在不同环境上有无法编译通过的可能性，也有不够安全的问题存在，因而在实际编程中，我们常考虑按照数据大小上限开全局变量数组（常见于算法题的实现或demo中）或使用new方法（多见于实际工业与项目实现中）。


在本课程中，认为类似int array[len];的变长数组实现是非法的；此外，对于 int array[0];这种零长数组也认为是非法的。


（ by 王超然、郑傲宇、郭淳）
